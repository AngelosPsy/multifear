#' exclusion_criteria
#'
#' \lifecycle{experimental}
#'
#' @description Exclusion criteria
#' @param data a data object generated by the \code{multics::chop_css} function
## @param cutoff cut off score. Default to 0.01
#' @details Here the different exclusion criteria are applied to the provided data.
#' @export

exclusion_criteria <- function(data){ #, cutoff = 0.01) {
  # Check data
  chop_css_warning(data)

  full_data  <- data %>% dplyr::select(dplyr::matches("cs1_t_|cs2_t_"), id)
  ten_per    <- data %>% dplyr::select(cs1_t10per, cs1_b10per, cs2_t10per, cs2_b10per, id)
  min_first  <- data %>% dplyr::select(cs1_minfirst, cs2_minfirst, id)
  th3_per    <- data %>% dplyr::select(dplyr::contains("33per"), id)
  halves     <- data %>% dplyr::select(cs1_fhalf, cs1_lhalf, cs2_fhalf, cs2_lhalf, id)
  fltrials   <-  data %>% dplyr::select(cs1_ftrial, cs1_ltrial, cs2_ftrial, cs2_ltrial, id)
  twenty_per <-  data %>% dplyr::select(dplyr::contains("20per"), id)
  fl2trials  <- data %>% dplyr::select(cs1_f2trial, cs1_l2trial, cs2_f2trial, cs2_l2trial, id)
  per2trials <-  data %>% dplyr::select(dplyr::matches("cs1_per2|cs2_per2"), id)

 res <- tidyr::tibble(
    used_data = list(
      full_data   = full_data,
      ten_per     = ten_per,
      min_first   = min_first,
      th3_per     = th3_per,
      halves      = halves,
      fltrials    = fltrials,
      twenty_per  = twenty_per,
      fl2trials   = fl2trials,
      per2trials  = per2trials
  ))

 res <- res %>%
   dplyr::mutate(names = names(.$used_data))
  return(res)
}
